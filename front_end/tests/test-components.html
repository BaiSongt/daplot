<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DaPlot 组件测试</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            margin: 20px;
            background: #f8f9fa;
        }
        
        .test-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        .test-section h3 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        
        .test-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 15px 0;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-warning { background: #ffc107; color: #212529; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-secondary { background: #6c757d; color: white; }
        
        .btn:hover { opacity: 0.8; }
        
        .component-container {
            min-height: 100px;
            border: 1px dashed #ccc;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            background: #fafafa;
        }
        
        .tooltip-demo {
            display: inline-block;
            margin: 10px;
            padding: 8px 12px;
            background: #007bff;
            color: white;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>🧪 DaPlot 组件测试页面</h1>
    <p>这个页面用于测试新创建的UI组件功能</p>

    <!-- LoadingSpinner 测试 -->
    <div class="test-section">
        <h3>📊 LoadingSpinner 加载动画组件</h3>
        <div class="test-buttons">
            <button class="btn btn-primary" onclick="testLoadingSpinner('spinner')">旋转加载</button>
            <button class="btn btn-primary" onclick="testLoadingSpinner('dots')">点状加载</button>
            <button class="btn btn-primary" onclick="testLoadingSpinner('bars')">条状加载</button>
            <button class="btn btn-primary" onclick="testLoadingSpinner('pulse')">脉冲加载</button>
            <button class="btn btn-primary" onclick="testLoadingSpinner('ring')">环形加载</button>
            <button class="btn btn-secondary" onclick="hideLoadingSpinner()">隐藏加载</button>
        </div>
        <div id="loading-container" class="component-container"></div>
    </div>

    <!-- StatusMessage 测试 -->
    <div class="test-section">
        <h3>💬 StatusMessage 状态消息组件</h3>
        <div class="test-buttons">
            <button class="btn btn-success" onclick="testStatusMessage('success')">成功消息</button>
            <button class="btn btn-danger" onclick="testStatusMessage('error')">错误消息</button>
            <button class="btn btn-warning" onclick="testStatusMessage('warning')">警告消息</button>
            <button class="btn btn-primary" onclick="testStatusMessage('info')">信息消息</button>
            <button class="btn btn-secondary" onclick="testNotifications()">通知消息</button>
        </div>
        <div id="status-container" class="component-container"></div>
    </div>

    <!-- Modal 测试 -->
    <div class="test-section">
        <h3>🪟 Modal 模态框组件</h3>
        <div class="test-buttons">
            <button class="btn btn-primary" onclick="testModal('basic')">基础模态框</button>
            <button class="btn btn-primary" onclick="testModal('large')">大型模态框</button>
            <button class="btn btn-success" onclick="testModal('confirm')">确认对话框</button>
            <button class="btn btn-warning" onclick="testModal('alert')">警告对话框</button>
            <button class="btn btn-secondary" onclick="testModal('prompt')">输入对话框</button>
        </div>
    </div>

    <!-- Tooltip 测试 -->
    <div class="test-section">
        <h3>💡 Tooltip 提示框组件</h3>
        <p>将鼠标悬停在下面的元素上查看提示效果：</p>
        <div>
            <span class="tooltip-demo" data-tooltip="这是一个顶部提示" data-placement="top">顶部提示</span>
            <span class="tooltip-demo" data-tooltip="这是一个底部提示" data-placement="bottom">底部提示</span>
            <span class="tooltip-demo" data-tooltip="这是一个左侧提示" data-placement="left">左侧提示</span>
            <span class="tooltip-demo" data-tooltip="这是一个右侧提示" data-placement="right">右侧提示</span>
            <span class="tooltip-demo" data-tooltip="这是一个亮色主题提示" data-theme="light">亮色主题</span>
        </div>
    </div>

    <!-- ErrorBoundary 测试 -->
    <div class="test-section">
        <h3>🚨 ErrorBoundary 错误边界组件</h3>
        <div class="test-buttons">
            <button class="btn btn-danger" onclick="testErrorBoundary()">触发错误</button>
            <button class="btn btn-secondary" onclick="clearErrorBoundary()">清除错误</button>
        </div>
        <div id="error-container" class="component-container">
            <p>这里是正常内容，点击"触发错误"按钮测试错误处理</p>
        </div>
    </div>

    <!-- ChartConfig 测试 -->
    <div class="test-section">
        <h3>⚙️ ChartConfig 图表配置组件</h3>
        <div class="test-buttons">
            <button class="btn btn-primary" onclick="testChartConfig()">显示配置面板</button>
            <button class="btn btn-secondary" onclick="hideChartConfig()">隐藏配置面板</button>
        </div>
        <div id="chart-config-container" class="component-container"></div>
    </div>

    <!-- 加载组件脚本 -->
    <script src="src/utils/constants.js"></script>
    <script src="src/components/LoadingSpinner.js"></script>
    <script src="src/components/StatusMessage.js"></script>
    <script src="src/components/Modal.js"></script>
    <script src="src/components/Tooltip.js"></script>
    <script src="src/components/ErrorBoundary.js"></script>
    <script src="src/components/ChartConfig.js"></script>

    <script>
        // 全局变量
        let loadingSpinner = null;
        let statusMessage = null;
        let errorBoundary = null;
        let chartConfig = null;

        // LoadingSpinner 测试
        function testLoadingSpinner(type) {
            if (loadingSpinner) {
                loadingSpinner.destroy();
            }
            
            loadingSpinner = new LoadingSpinner({
                container: 'loading-container',
                type: type,
                text: `正在加载 (${type})...`,
                size: 'medium',
                color: '#007bff'
            });
            
            loadingSpinner.show();
        }

        function hideLoadingSpinner() {
            if (loadingSpinner) {
                loadingSpinner.hide();
            }
        }

        // StatusMessage 测试
        function testStatusMessage(type) {
            if (statusMessage) {
                statusMessage.destroy();
            }

            const messages = {
                success: '操作成功完成！',
                error: '发生了一个错误，请重试。',
                warning: '请注意，这是一个警告信息。',
                info: '这是一条信息提示。'
            };

            statusMessage = new StatusMessage({
                container: 'status-container',
                type: type,
                message: messages[type],
                title: type.charAt(0).toUpperCase() + type.slice(1),
                autoClose: true,
                autoCloseDelay: 3000
            });

            statusMessage.show();
        }

        function testNotifications() {
            StatusMessage.notify('这是一个通知消息', 'info');
            setTimeout(() => StatusMessage.notify('这是一个成功通知', 'success'), 500);
            setTimeout(() => StatusMessage.notify('这是一个警告通知', 'warning'), 1000);
        }

        // Modal 测试
        async function testModal(type) {
            switch (type) {
                case 'basic':
                    const modal = new Modal({
                        title: '基础模态框',
                        content: '<p>这是一个基础的模态框示例。</p><p>您可以在这里放置任何内容。</p>',
                        size: 'medium',
                        showFooter: true
                    });
                    modal.show();
                    break;

                case 'large':
                    const largeModal = new Modal({
                        title: '大型模态框',
                        content: '<p>这是一个大型模态框，适合显示更多内容。</p>'.repeat(10),
                        size: 'large',
                        scrollable: true,
                        showFooter: true
                    });
                    largeModal.show();
                    break;

                case 'confirm':
                    const confirmed = await Modal.confirm('您确定要执行这个操作吗？', {
                        title: '确认操作'
                    });
                    alert(confirmed ? '用户确认了操作' : '用户取消了操作');
                    break;

                case 'alert':
                    await Modal.alert('这是一个警告消息！', {
                        title: '警告'
                    });
                    break;

                case 'prompt':
                    const result = await Modal.prompt('请输入您的姓名：', '张三', {
                        title: '输入信息'
                    });
                    if (result !== null) {
                        alert(`您输入的姓名是：${result}`);
                    }
                    break;
            }
        }

        // ErrorBoundary 测试
        function testErrorBoundary() {
            if (!errorBoundary) {
                errorBoundary = new ErrorBoundary({
                    container: 'error-container',
                    showDetails: true,
                    allowRetry: true
                });
            }

            // 模拟错误
            errorBoundary.handleError(new Error('这是一个测试错误'), {
                type: 'test',
                message: '用户触发的测试错误'
            });
        }

        function clearErrorBoundary() {
            if (errorBoundary) {
                errorBoundary.clearError();
            }
        }

        // ChartConfig 测试
        function testChartConfig() {
            if (chartConfig) {
                chartConfig.destroy();
            }

            chartConfig = new ChartConfig({
                container: 'chart-config-container',
                chartType: 'scatter',
                showPreview: true,
                showPresets: true,
                onChange: (config, key, value) => {
                    console.log('配置变更:', key, value);
                },
                onApply: (config) => {
                    console.log('应用配置:', config);
                    alert('配置已应用！查看控制台了解详情。');
                }
            });
        }

        function hideChartConfig() {
            if (chartConfig) {
                chartConfig.destroy();
                chartConfig = null;
            }
        }

        // 页面加载完成后的初始化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🎉 组件测试页面加载完成！');
            console.log('可用组件:', {
                LoadingSpinner: typeof LoadingSpinner !== 'undefined',
                StatusMessage: typeof StatusMessage !== 'undefined',
                Modal: typeof Modal !== 'undefined',
                Tooltip: typeof Tooltip !== 'undefined',
                ErrorBoundary: typeof ErrorBoundary !== 'undefined',
                ChartConfig: typeof ChartConfig !== 'undefined'
            });
        });
    </script>
</body>
</html>