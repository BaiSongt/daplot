<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DaPlot - æ•°æ®å¯è§†åŒ–å¹³å°</title>
    
    <!-- æ–°çš„æ¨¡å—åŒ–æ¶æ„ -->
    <script src="src/utils/constants.js"></script>
    <script src="src/utils/helpers.js"></script>
    <script src="src/utils/formatters.js"></script>
    <script src="src/core/ConfigManager.js"></script>
    <script src="src/core/EventBus.js"></script>
    <script src="src/core/ApiClient.js"></script>
    <script src="src/core/AppState.js"></script>
    <script src="src/core/DataManager.js"></script>
    <script src="src/components/LoadingSpinner.js"></script>
    <script src="src/components/StatusMessage.js"></script>
    <script src="src/components/ErrorBoundary.js"></script>
    <script src="src/components/Modal.js"></script>
    <script src="src/components/Tooltip.js"></script>
    <script src="src/daplot.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .page-wrapper {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            flex-shrink: 0;
            background: rgba(248, 249, 250, 0.95);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(222, 226, 230, 0.5);
            transition: width 0.3s ease;
            padding: 15px;
            display: flex;
            flex-direction: column;
            font-size: 12px;
            position: relative;
        } 
       .sidebar.collapsed {
            width: 50px;
            padding: 15px 5px;
        }

        .sidebar.collapsed .sidebar-content {
            display: none;
        }

        .sidebar-toggle {
            position: absolute;
            top: 15px;
            right: 10px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 3px;
            padding: 5px 8px;
            cursor: pointer;
            font-size: 12px;
            z-index: 1000;
            transition: all 0.2s;
        }

        .sidebar-toggle:hover {
            background: #0056b3;
            transform: scale(1.05);
        }

        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            color: #333;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(233, 236, 239, 0.5);
        }

        .sidebar-header h1 {
            font-size: 1.3rem;
            margin: 0;
            font-weight: 600;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-bar {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 20px;
        }

        .nav-btn {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: #666;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.7);
            border: none;
            cursor: pointer;
            backdrop-filter: blur(5px);
        }

        .nav-btn:hover {
            background: rgba(74, 144, 226, 0.1);
            color: #4a90e2;
            transform: translateX(3px);
            box-shadow: 0 2px 10px rgba(74, 144, 226, 0.2);
        }

        .nav-btn.active {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
        }

        .nav-btn i {
            margin-right: 10px;
            font-size: 16px;
            width: 16px;
            text-align: center;
        }

        .content-area {
            flex: 1;
            padding: 0;
            overflow-y: auto;
            width: 100%;
        }

        .main-content {
            width: 100%;
            padding: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            text-align: center;
        }

        .hero-section {
            max-width: 800px;
            margin-bottom: 60px;
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #fff, #f8f9fa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 2px 20px rgba(255, 255, 255, 0.3);
        }

        .hero-subtitle {
            font-size: 1.3rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .hero-description {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.8;
            margin-bottom: 40px;
        }

        .action-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 60px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .btn-primary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .btn-primary:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.2);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-2px);
        }

        .features-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            max-width: 1000px;
            margin-bottom: 60px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 30px 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .feature-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: white;
            margin-bottom: 10px;
        }

        .feature-description {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .stats-section {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
            margin-bottom: 40px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: white;
            display: block;
            margin-bottom: 5px;
        }

        .stat-label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }

        .quick-start {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 30px;
            max-width: 600px;
            margin-top: 40px;
        }

        .quick-start h3 {
            color: white;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .quick-start-steps {
            text-align: left;
            color: rgba(255, 255, 255, 0.9);
        }

        .quick-start-steps ol {
            padding-left: 20px;
        }

        .quick-start-steps li {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .sidebar {
                width: 60px;
            }
            
            .sidebar:not(.collapsed) {
                width: 250px;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .hero-title {
                font-size: 2.5rem;
            }
            
            .hero-subtitle {
                font-size: 1.1rem;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .features-section {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .stats-section {
                gap: 20px;
            }
        }

        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.8s ease-out;
        }

        .fade-in-up-delay-1 {
            animation: fadeInUp 0.8s ease-out 0.2s both;
        }

        .fade-in-up-delay-2 {
            animation: fadeInUp 0.8s ease-out 0.4s both;
        }

        .fade-in-up-delay-3 {
            animation: fadeInUp 0.8s ease-out 0.6s both;
        }

        /* çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .status-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 10px 15px;
            color: white;
            font-size: 12px;
            display: none;
        }

        .status-indicator.show {
            display: block;
            animation: fadeInUp 0.3s ease-out;
        }
    </style>
</head>
<body>  
  <!-- å…¨å±€åŠ è½½é®ç½© -->
    <div id="global-loading" style="display: none;"></div>
    
    <!-- å…¨å±€é”™è¯¯è¾¹ç•Œ -->
    <div id="global-error-boundary" style="display: none;"></div>

    <!-- çŠ¶æ€æŒ‡ç¤ºå™¨ -->
    <div class="status-indicator" id="status-indicator">
        <span id="status-text">ç³»ç»Ÿå°±ç»ª</span>
    </div>

    <div class="page-wrapper">
        <!-- ä¾§è¾¹æ  -->
        <div class="sidebar" id="sidebar">
            <button class="sidebar-toggle" onclick="toggleSidebar()" data-tooltip="åˆ‡æ¢ä¾§è¾¹æ " data-placement="right">â˜°</button>
            
            <div class="sidebar-content">
                <div class="sidebar-header">
                    <h1>DaPlot</h1>
                </div>

                <nav class="nav-bar">
                    <a href="index.html" class="nav-btn active" data-tooltip="åº”ç”¨é¦–é¡µ" data-placement="right">
                        <i>ğŸ </i>
                        <span>é¦–é¡µ</span>
                    </a>
                    <a href="data_integrated.html" class="nav-btn" data-tooltip="æ•°æ®ç¼–è¾‘å’Œç®¡ç†" data-placement="right">
                        <i>ğŸ“Š</i>
                        <span>æ•°æ®æ“ä½œ</span>
                    </a>
                    <a href="visualization.html" class="nav-btn" data-tooltip="åˆ›å»ºæ•°æ®å¯è§†åŒ–å›¾è¡¨" data-placement="right">
                        <i>ğŸ“ˆ</i>
                        <span>å¯è§†åŒ–ç»˜å›¾</span>
                    </a>
                    <a href="prediction.html" class="nav-btn" data-tooltip="æ•°æ®é¢„æµ‹å’Œåˆ†æ" data-placement="right">
                        <i>ğŸ”®</i>
                        <span>æ•°æ®é¢„æµ‹</span>
                    </a>
                    <a href="donate.html" class="nav-btn" data-tooltip="æ”¯æŒé¡¹ç›®å‘å±•" data-placement="right">
                        <i>â¤ï¸</i>
                        <span>æèµ æ”¯æŒ</span>
                    </a>
                </nav>

                <!-- ç³»ç»ŸçŠ¶æ€ -->
                <div style="margin-top: auto; padding-top: 20px; border-top: 1px solid rgba(233, 236, 239, 0.5);">
                    <div style="font-size: 11px; color: #6c757d; text-align: center;">
                        <div>ç‰ˆæœ¬: <span id="app-version">1.0.0</span></div>
                        <div>çŠ¶æ€: <span id="app-status" style="color: #28a745;">æ­£å¸¸</span></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¸»å†…å®¹åŒº -->
        <div class="content-area">
            <div class="main-content">
                <!-- è‹±é›„åŒºåŸŸ -->
                <div class="hero-section fade-in-up">
                    <h1 class="hero-title">DaPlot</h1>
                    <p class="hero-subtitle">å¼ºå¤§çš„æ•°æ®å¯è§†åŒ–å¹³å°</p>
                    <p class="hero-description">
                        é›†æ•°æ®ç¼–è¾‘ã€å¯è§†åŒ–ç»˜å›¾ã€æ™ºèƒ½é¢„æµ‹äºä¸€ä½“çš„ç°ä»£åŒ–æ•°æ®åˆ†æå·¥å…·ã€‚
                        æ”¯æŒå¤šç§æ•°æ®æ ¼å¼ï¼Œæä¾›ä¸°å¯Œçš„å›¾è¡¨ç±»å‹å’Œé¢„æµ‹ç®—æ³•ï¼Œè®©æ•°æ®åˆ†æå˜å¾—ç®€å•é«˜æ•ˆã€‚
                    </p>
                    
                    <div class="action-buttons">
                        <a href="data_integrated.html" class="btn btn-primary">
                            <span>ğŸš€</span>
                            å¼€å§‹ä½¿ç”¨
                        </a>
                        <a href="visualization.html" class="btn btn-secondary">
                            <span>ğŸ“ˆ</span>
                            åˆ›å»ºå›¾è¡¨
                        </a>
                        <button class="btn btn-secondary" onclick="showQuickTour()">
                            <span>ğŸ¯</span>
                            å¿«é€Ÿå¯¼è§ˆ
                        </button>
                    </div>
                </div>

                <!-- ç»Ÿè®¡æ•°æ® -->
                <div class="stats-section fade-in-up-delay-1">
                    <div class="stat-item">
                        <span class="stat-number" id="files-count">0</span>
                        <span class="stat-label">æ•°æ®æ–‡ä»¶</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="charts-created">0</span>
                        <span class="stat-label">åˆ›å»ºå›¾è¡¨</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="predictions-made">0</span>
                        <span class="stat-label">é¢„æµ‹åˆ†æ</span>
                    </div>
                </div>

                <!-- åŠŸèƒ½ç‰¹æ€§ -->
                <div class="features-section fade-in-up-delay-2">
                    <div class="feature-card">
                        <span class="feature-icon">ğŸ“Š</span>
                        <h3 class="feature-title">æ•°æ®ç¼–è¾‘</h3>
                        <p class="feature-description">
                            æ”¯æŒExcelã€CSVç­‰å¤šç§æ ¼å¼ï¼Œæä¾›ç±»ä¼¼Excelçš„åœ¨çº¿ç¼–è¾‘ä½“éªŒï¼Œ
                            å®æ—¶ä¿å­˜ï¼Œå¤šå·¥ä½œè¡¨æ”¯æŒã€‚
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">ğŸ“ˆ</span>
                        <h3 class="feature-title">å¯è§†åŒ–ç»˜å›¾</h3>
                        <p class="feature-description">
                            ä¸°å¯Œçš„å›¾è¡¨ç±»å‹ï¼Œçµæ´»çš„æ ·å¼é…ç½®ï¼Œå®æ—¶é¢„è§ˆï¼Œ
                            æ”¯æŒäº¤äº’å¼å›¾è¡¨å’Œå¤šç§å¯¼å‡ºæ ¼å¼ã€‚
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">ğŸ”®</span>
                        <h3 class="feature-title">æ™ºèƒ½é¢„æµ‹</h3>
                        <p class="feature-description">
                            é›†æˆå¤šç§æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œæ”¯æŒçº¿æ€§å›å½’ã€ç¥ç»ç½‘ç»œç­‰ï¼Œ
                            å¯è§†åŒ–é¢„æµ‹ç»“æœï¼Œå¯¼å‡ºåˆ†ææŠ¥å‘Šã€‚
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">âš¡</span>
                        <h3 class="feature-title">é«˜æ€§èƒ½</h3>
                        <p class="feature-description">
                            æ¨¡å—åŒ–æ¶æ„ï¼Œæ™ºèƒ½ç¼“å­˜ï¼Œç¦»çº¿æ”¯æŒï¼Œ
                            å¿«é€Ÿå“åº”ï¼Œæµç•…çš„ç”¨æˆ·ä½“éªŒã€‚
                        </p>
                    </div>
                </div>

                <!-- å¿«é€Ÿå¼€å§‹ -->
                <div class="quick-start fade-in-up-delay-3">
                    <h3>ğŸš€ å¿«é€Ÿå¼€å§‹</h3>
                    <div class="quick-start-steps">
                        <ol>
                            <li>ä¸Šä¼ æ‚¨çš„æ•°æ®æ–‡ä»¶ï¼ˆExcelã€CSVæ ¼å¼ï¼‰</li>
                            <li>åœ¨æ•°æ®æ“ä½œé¡µé¢ç¼–è¾‘å’Œæ•´ç†æ•°æ®</li>
                            <li>åœ¨å¯è§†åŒ–é¡µé¢åˆ›å»ºå›¾è¡¨å’Œåˆ†æ</li>
                            <li>ä½¿ç”¨é¢„æµ‹åŠŸèƒ½è¿›è¡Œæ•°æ®é¢„æµ‹åˆ†æ</li>
                            <li>å¯¼å‡ºç»“æœå’ŒæŠ¥å‘Š</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let globalLoading = null;
        let globalErrorBoundary = null;
        let statsUpdateTimer = null;

        // é¡µé¢åˆå§‹åŒ–
        async function initializePage() {
            try {
                console.log('ğŸš€ å¼€å§‹åˆå§‹åŒ–ä¸»é¡µ...');

                // æ˜¾ç¤ºçŠ¶æ€æŒ‡ç¤ºå™¨
                showStatusIndicator('æ­£åœ¨åˆå§‹åŒ–...');

                // ç­‰å¾…DaPlotæ ¸å¿ƒæ¨¡å—åŠ è½½å®Œæˆ
                if (typeof window.initializeDaPlot === 'function') {
                    await window.initializeDaPlot();
                }

                // åˆå§‹åŒ–å…¨å±€ç»„ä»¶
                initializeGlobalComponents();

                // åˆå§‹åŒ–é¡µé¢åŠŸèƒ½
                initializePageFeatures();

                // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
                bindEventListeners();

                // åŠ è½½ç»Ÿè®¡æ•°æ®
                await loadStatistics();

                // å¯åŠ¨å®šæœŸæ›´æ–°
                startPeriodicUpdates();

                showStatusIndicator('ç³»ç»Ÿå°±ç»ª', 2000);
                console.log('âœ… ä¸»é¡µåˆå§‹åŒ–å®Œæˆ');

            } catch (error) {
                console.error('âŒ é¡µé¢åˆå§‹åŒ–å¤±è´¥:', error);
                showStatusIndicator('åˆå§‹åŒ–å¤±è´¥', 0);
                showError('é¡µé¢åˆå§‹åŒ–å¤±è´¥: ' + error.message);
            }
        }

        // åˆå§‹åŒ–å…¨å±€ç»„ä»¶
        function initializeGlobalComponents() {
            // å…¨å±€åŠ è½½å™¨
            globalLoading = LoadingSpinner.createGlobal({
                text: 'æ­£åœ¨å¤„ç†...',
                type: 'spinner',
                size: 'large'
            });

            // å…¨å±€é”™è¯¯è¾¹ç•Œ
            globalErrorBoundary = ErrorBoundary.createGlobal({
                showDetails: true,
                allowRetry: true,
                onError: (error, errorInfo) => {
                    console.error('å…¨å±€é”™è¯¯:', error, errorInfo);
                }
            });
        }

        // åˆå§‹åŒ–é¡µé¢åŠŸèƒ½
        function initializePageFeatures() {
            // åˆå§‹åŒ–æç¤ºæ¡†
            Tooltip.init('[data-tooltip]');

            // æ›´æ–°ç‰ˆæœ¬ä¿¡æ¯
            updateVersionInfo();

            // æ·»åŠ åŠ¨ç”»æ•ˆæœ
            addScrollAnimations();
        }

        // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
        function bindEventListeners() {
            // ç›‘å¬åº”ç”¨çŠ¶æ€å˜åŒ–
            if (window.appState) {
                window.appState.subscribe('*', handleAppStateChange);
            }

            // ç›‘å¬äº‹ä»¶æ€»çº¿äº‹ä»¶
            if (window.eventBus) {
                window.eventBus.on('file.uploaded', handleFileUploaded);
                window.eventBus.on('chart.created', handleChartCreated);
                window.eventBus.on('prediction.completed', handlePredictionCompleted);
            }

            // é”®ç›˜å¿«æ·é”®
            document.addEventListener('keydown', handleKeyboardShortcuts);

            // çª—å£å¤§å°å˜åŒ–
            window.addEventListener('resize', handleWindowResize);
        }

        // åŠ è½½ç»Ÿè®¡æ•°æ®
        async function loadStatistics() {
            try {
                // è·å–æ–‡ä»¶æ•°é‡
                if (window.dataManager) {
                    const fileList = await window.dataManager.getFileList();
                    updateStatistic('files-count', fileList.length);
                }

                // ä»æœ¬åœ°å­˜å‚¨è·å–å…¶ä»–ç»Ÿè®¡æ•°æ®
                const chartsCreated = localStorage.getItem('daplot_charts_created') || 0;
                const predictionsMade = localStorage.getItem('daplot_predictions_made') || 0;

                updateStatistic('charts-created', chartsCreated);
                updateStatistic('predictions-made', predictionsMade);

            } catch (error) {
                console.error('åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
            }
        }

        // æ›´æ–°ç»Ÿè®¡æ•°æ®
        function updateStatistic(elementId, value) {
            const element = document.getElementById(elementId);
            if (element) {
                // æ•°å­—åŠ¨ç”»æ•ˆæœ
                animateNumber(element, parseInt(element.textContent) || 0, parseInt(value) || 0);
            }
        }

        // æ•°å­—åŠ¨ç”»
        function animateNumber(element, start, end, duration = 1000) {
            const startTime = performance.now();
            
            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                const current = Math.floor(start + (end - start) * progress);
                element.textContent = current;
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }
            
            requestAnimationFrame(update);
        }

        // æ˜¾ç¤ºå¿«é€Ÿå¯¼è§ˆ
        async function showQuickTour() {
            const tourSteps = [
                {
                    title: 'æ¬¢è¿ä½¿ç”¨ DaPlot',
                    content: 'DaPlot æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ•°æ®å¯è§†åŒ–å¹³å°ï¼Œè®©æˆ‘ä»¬å¿«é€Ÿäº†è§£ä¸»è¦åŠŸèƒ½ã€‚'
                },
                {
                    title: 'æ•°æ®æ“ä½œ',
                    content: 'åœ¨æ•°æ®æ“ä½œé¡µé¢ï¼Œæ‚¨å¯ä»¥ä¸Šä¼ ã€ç¼–è¾‘å’Œç®¡ç†æ‚¨çš„æ•°æ®æ–‡ä»¶ã€‚æ”¯æŒ Excel å’Œ CSV æ ¼å¼ã€‚'
                },
                {
                    title: 'å¯è§†åŒ–ç»˜å›¾',
                    content: 'åˆ›å»ºå„ç§ç±»å‹çš„å›¾è¡¨ï¼ŒåŒ…æ‹¬æ•£ç‚¹å›¾ã€æŠ˜çº¿å›¾ã€æŸ±çŠ¶å›¾ç­‰ã€‚æ”¯æŒå®æ—¶é¢„è§ˆå’Œæ ·å¼è‡ªå®šä¹‰ã€‚'
                },
                {
                    title: 'æ•°æ®é¢„æµ‹',
                    content: 'ä½¿ç”¨æœºå™¨å­¦ä¹ ç®—æ³•è¿›è¡Œæ•°æ®é¢„æµ‹åˆ†æï¼Œæ”¯æŒå¤šç§é¢„æµ‹æ¨¡å‹å’Œç»“æœå¯è§†åŒ–ã€‚'
                },
                {
                    title: 'å¼€å§‹ä½¿ç”¨',
                    content: 'ç°åœ¨æ‚¨å¯ä»¥å¼€å§‹ä½¿ç”¨ DaPlot äº†ï¼å»ºè®®å…ˆä¸Šä¼ ä¸€ä¸ªæ•°æ®æ–‡ä»¶å¼€å§‹ä½“éªŒã€‚'
                }
            ];

            for (let i = 0; i < tourSteps.length; i++) {
                const step = tourSteps[i];
                const isLast = i === tourSteps.length - 1;
                
                await Modal.alert(step.content, {
                    title: `${step.title} (${i + 1}/${tourSteps.length})`,
                    buttonText: isLast ? 'å¼€å§‹ä½¿ç”¨' : 'ä¸‹ä¸€æ­¥'
                });
            }
        }

        // å¯åŠ¨å®šæœŸæ›´æ–°
        function startPeriodicUpdates() {
            // æ¯30ç§’æ›´æ–°ä¸€æ¬¡ç»Ÿè®¡æ•°æ®
            statsUpdateTimer = setInterval(async () => {
                try {
                    await loadStatistics();
                } catch (error) {
                    console.error('å®šæœŸæ›´æ–°ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
                }
            }, 30000);
        }

        // æ›´æ–°ç‰ˆæœ¬ä¿¡æ¯
        function updateVersionInfo() {
            const versionElement = document.getElementById('app-version');
            const statusElement = document.getElementById('app-status');
            
            if (window.DAPLOT_VERSION) {
                versionElement.textContent = window.DAPLOT_VERSION;
            }

            // æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
            checkSystemStatus().then(status => {
                statusElement.textContent = status.text;
                statusElement.style.color = status.color;
            });
        }

        // æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
        async function checkSystemStatus() {
            try {
                // æ£€æŸ¥æ ¸å¿ƒæ¨¡å—æ˜¯å¦æ­£å¸¸
                const coreModules = [
                    'appState', 'dataManager', 'chartEngine', 'eventBus', 'apiClient'
                ];

                let healthyModules = 0;
                for (const module of coreModules) {
                    if (window[module]) {
                        healthyModules++;
                    }
                }

                const healthPercentage = (healthyModules / coreModules.length) * 100;

                if (healthPercentage === 100) {
                    return { text: 'æ­£å¸¸', color: '#28a745' };
                } else if (healthPercentage >= 80) {
                    return { text: 'è‰¯å¥½', color: '#ffc107' };
                } else {
                    return { text: 'å¼‚å¸¸', color: '#dc3545' };
                }

            } catch (error) {
                return { text: 'é”™è¯¯', color: '#dc3545' };
            }
        }

        // æ·»åŠ æ»šåŠ¨åŠ¨ç”»
        function addScrollAnimations() {
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, observerOptions);

            // è§‚å¯Ÿæ‰€æœ‰åŠ¨ç”»å…ƒç´ 
            document.querySelectorAll('.fade-in-up, .fade-in-up-delay-1, .fade-in-up-delay-2, .fade-in-up-delay-3').forEach(el => {
                observer.observe(el);
            });
        }

        // æ˜¾ç¤ºçŠ¶æ€æŒ‡ç¤ºå™¨
        function showStatusIndicator(text, duration = 3000) {
            const indicator = document.getElementById('status-indicator');
            const textElement = document.getElementById('status-text');
            
            textElement.textContent = text;
            indicator.classList.add('show');
            
            if (duration > 0) {
                setTimeout(() => {
                    indicator.classList.remove('show');
                }, duration);
            }
        }

        // äº‹ä»¶å¤„ç†å‡½æ•°
        function handleAppStateChange(newState, oldState) {
            console.log('åº”ç”¨çŠ¶æ€å˜åŒ–:', newState);
        }

        function handleFileUploaded(data) {
            console.log('æ–‡ä»¶ä¸Šä¼ äº‹ä»¶:', data);
            // æ›´æ–°æ–‡ä»¶ç»Ÿè®¡
            loadStatistics();
        }

        function handleChartCreated(data) {
            console.log('å›¾è¡¨åˆ›å»ºäº‹ä»¶:', data);
            // å¢åŠ å›¾è¡¨è®¡æ•°
            const current = parseInt(localStorage.getItem('daplot_charts_created') || 0);
            localStorage.setItem('daplot_charts_created', current + 1);
            loadStatistics();
        }

        function handlePredictionCompleted(data) {
            console.log('é¢„æµ‹å®Œæˆäº‹ä»¶:', data);
            // å¢åŠ é¢„æµ‹è®¡æ•°
            const current = parseInt(localStorage.getItem('daplot_predictions_made') || 0);
            localStorage.setItem('daplot_predictions_made', current + 1);
            loadStatistics();
        }

        function handleKeyboardShortcuts(e) {
            // Ctrl+H: æ˜¾ç¤ºå¸®åŠ©
            if (e.ctrlKey && e.key === 'h') {
                e.preventDefault();
                showQuickTour();
            }
            
            // F1: æ˜¾ç¤ºå¸®åŠ©
            if (e.key === 'F1') {
                e.preventDefault();
                showQuickTour();
            }
        }

        function handleWindowResize() {
            // å“åº”å¼å¤„ç†
            const sidebar = document.getElementById('sidebar');
            if (window.innerWidth <= 768) {
                sidebar.classList.add('collapsed');
            }
        }

        // å·¥å…·å‡½æ•°
        function showError(message) {
            StatusMessage.error(message, { autoCloseDelay: 5000 });
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('collapsed');
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initializePage);

        // é¡µé¢å¸è½½æ—¶æ¸…ç†
        window.addEventListener('beforeunload', () => {
            if (statsUpdateTimer) {
                clearInterval(statsUpdateTimer);
            }
            
            if (globalLoading) globalLoading.destroy();
            if (globalErrorBoundary) globalErrorBoundary.destroy();
        });

        // é¡µé¢å¯è§æ€§å˜åŒ–å¤„ç†
        document.addEventListener('visibilitychange', () => {
            if (document.visibilityState === 'visible') {
                // é¡µé¢é‡æ–°å¯è§æ—¶æ›´æ–°ç»Ÿè®¡æ•°æ®
                loadStatistics();
            }
        });
    </script>
</body>
</html>